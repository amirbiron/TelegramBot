<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××“×¨×™×š: ×›×™×¦×“ ×œ×‘× ×•×ª ×‘×•×˜×™× ×™×¢×™×œ×™× ×•××§×¦×•×¢×™×™×</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0d1117;
            --secondary: #161b22;
            --accent: #58a6ff;
            --success: #238636;
            --warning: #d29922;
            --danger: #f85149;
            --text: #c9d1d9;
            --text-muted: #8b949e;
            --border: #30363d;
            --code-bg: #0d1117;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans Hebrew', 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #0d1117 0%, #161b22 100%);
            color: var(--text);
            line-height: 1.8;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--secondary);
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #1f6feb 0%, #0d419d 100%);
            padding: 60px 40px;
            text-align: center;
            border-bottom: 3px solid var(--accent);
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            color: rgba(255,255,255,0.9);
            max-width: 700px;
            margin: 0 auto;
        }

        .emoji {
            font-size: 1.3em;
            margin-left: 10px;
        }

        nav {
            background: var(--primary);
            padding: 20px 40px;
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        nav a {
            color: var(--accent);
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        nav a:hover {
            background: var(--accent);
            color: var(--primary);
            border-color: var(--accent);
        }

        main {
            padding: 40px;
        }

        section {
            margin-bottom: 60px;
            scroll-margin-top: 80px;
        }

        h2 {
            font-size: 2em;
            margin-bottom: 25px;
            color: var(--accent);
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }

        h3 {
            font-size: 1.5em;
            margin: 30px 0 20px;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h4 {
            font-size: 1.2em;
            margin: 20px 0 15px;
            color: var(--text-muted);
        }

        p {
            margin-bottom: 15px;
            color: var(--text);
        }

        ul, ol {
            margin: 15px 0 15px 30px;
        }

        li {
            margin-bottom: 10px;
            color: var(--text);
        }

        .card {
            background: var(--primary);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 25px;
            margin: 20px 0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(88, 166, 255, 0.15);
        }

        .card-header {
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            color: var(--accent);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .highlight {
            background: linear-gradient(135deg, #1f6feb22 0%, #0d419d22 100%);
            border-right: 4px solid var(--accent);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .warning {
            background: linear-gradient(135deg, #d2992222 0%, #9e6a0322 100%);
            border-right: 4px solid var(--warning);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .success {
            background: linear-gradient(135deg, #23863622 0%, #1a662922 100%);
            border-right: 4px solid var(--success);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .danger {
            background: linear-gradient(135deg, #f8514922 0%, #da363322 100%);
            border-right: 4px solid var(--danger);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        pre {
            background: var(--code-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            direction: ltr;
            text-align: left;
        }

        code {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
            font-size: 0.9em;
            color: #79c0ff;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
            margin-left: 8px;
        }

        .badge-success { background: var(--success); color: #fff; }
        .badge-warning { background: var(--warning); color: #000; }
        .badge-danger { background: var(--danger); color: #fff; }
        .badge-info { background: var(--accent); color: #fff; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--primary);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid var(--border);
        }

        th {
            background: var(--code-bg);
            color: var(--accent);
            font-weight: bold;
        }

        tr:hover {
            background: rgba(88, 166, 255, 0.05);
        }

        .checklist {
            list-style: none;
            margin-right: 0;
        }

        .checklist li {
            padding: 10px;
            margin-bottom: 8px;
            background: var(--primary);
            border-radius: 6px;
            border-right: 3px solid var(--accent);
        }

        .checklist li::before {
            content: "âœ“";
            color: var(--success);
            font-weight: bold;
            margin-left: 10px;
        }

        footer {
            background: var(--primary);
            padding: 40px;
            text-align: center;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
        }

        .quote {
            border-right: 4px solid var(--accent);
            padding: 20px 30px;
            margin: 20px 0;
            background: var(--primary);
            border-radius: 8px;
            font-style: italic;
            color: var(--text-muted);
        }

        @media (max-width: 768px) {
            header h1 { font-size: 1.8em; }
            header p { font-size: 1em; }
            main { padding: 20px; }
            nav ul { flex-direction: column; }
            .grid { grid-template-columns: 1fr; }
        }

        .comparison-table {
            margin: 30px 0;
        }

        .comparison-table tr:first-child th {
            background: linear-gradient(135deg, #1f6feb 0%, #0d419d 100%);
            color: #fff;
        }

        .comparison-table td:first-child {
            font-weight: bold;
            color: var(--accent);
        }

        .good { color: var(--success); }
        .bad { color: var(--danger); }

        a {
            color: var(--accent);
            text-decoration: none;
            border-bottom: 1px dotted var(--accent);
            transition: border-bottom 0.3s;
        }

        a:hover {
            border-bottom: 1px solid var(--accent);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><span class="emoji">ğŸ¤–</span>×›×™×¦×“ ×œ×‘× ×•×ª ×‘×•×˜×™× ×™×¢×™×œ×™× ×•××§×¦×•×¢×™×™×</h1>
            <p>××“×¨×™×š ××§×™×£ ×”××‘×•×¡×¡ ×¢×œ × ×™×¡×™×•×Ÿ ××¢×©×™ ×‘×¤×™×ª×•×— CodeBot - ×‘×•×˜ ×™×™×¦×•×¨ ×¢× ××œ×¤×™ ××©×ª××©×™×</p>
        </header>

        <nav>
            <ul>
                <li><a href="#architecture">âš™ï¸ ××¨×›×™×˜×§×˜×•×¨×”</a></li>
                <li><a href="#monitoring">ğŸ§  × ×™×˜×•×¨</a></li>
                <li><a href="#data">ğŸ’¾ × ×™×”×•×œ × ×ª×•× ×™×</a></li>
                <li><a href="#testing">ğŸ§ª ×‘×“×™×§×•×ª</a></li>
                <li><a href="#logging">ğŸ“Š ×œ×•×’×™×</a></li>
                <li><a href="#security">ğŸ›¡ï¸ ××‘×˜×—×”</a></li>
                <li><a href="#cicd">ğŸ” CI/CD</a></li>
                <li><a href="#summary">ğŸ“Œ ×¡×™×›×•×</a></li>
            </ul>
        </nav>

        <main>
            <!-- ×”×§×“××” -->
            <section id="intro">
                <h2><span class="emoji">ğŸ‘‹</span>×œ××” ×”××“×¨×™×š ×”×–×”?</h2>
                
                <p>×‘× ×™×™×ª ×‘×•×˜ ×˜×œ×’×¨× ×–×” ×§×œ. ×‘× ×™×™×ª ×‘×•×˜ <strong>×™×¢×™×œ, ×™×¦×™×‘ ×•××§×¦×•×¢×™</strong> ×©××©×¨×ª ××œ×¤×™ ××©×ª××©×™× - ×–×” ××ª×’×¨ ××—×¨ ×œ×’××¨×™.</p>

                <p>×”××“×¨×™×š ×”×–×” ××‘×•×¡×¡ ×¢×œ ×œ×§×—×™× ××¢×©×™×™× ××¤×™×ª×•×— <strong>CodeBot</strong> - ×‘×•×˜ ×œ× ×™×”×•×œ ×§×•×“ ×¢×:</p>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">ğŸ“Š Coverage ×’×‘×•×”</div>
                        <p>×›×™×¡×•×™ ×˜×¡×˜×™× ××¢×œ 60% ×¢× ××™× ×˜×’×¨×¦×™×” ×œ-Codecov</p>
                    </div>
                    <div class="card">
                        <div class="card-header">ğŸ”„ CI/CD ××ª×§×“×</div>
                        <p>GitHub Actions ×¢× ×‘×“×™×§×•×ª ××•×˜×•××˜×™×•×ª ×•××™×–×•×’ ×—×›×</p>
                    </div>
                    <div class="card">
                        <div class="card-header">ğŸ“ˆ Monitoring ××•×‘× ×”</div>
                        <p>Structured logging, Sentry, Prometheus metrics</p>
                    </div>
                    <div class="card">
                        <div class="card-header">ğŸ›¡ï¸ ××‘×˜×—×” ××ª×§×“××ª</div>
                        <p>Secret scanning, encrypted tokens, rate limiting</p>
                    </div>
                </div>

                <div class="highlight">
                    <strong>ğŸ’¡ ×”×¢×™×§×¨×•×Ÿ ×”××¨×›×–×™:</strong> ×”×§×•×“ ×¢×¦××• ×”×•× ×¨×§ 30% ××”×¢×‘×•×“×”. 70% ×”××—×¨×™× ×”× ×ª×©×ª×™×•×ª, × ×™×˜×•×¨, ×‘×“×™×§×•×ª, ×ª×™×¢×•×“ ×•×ª×—×–×•×§×”.
                </div>
            </section>

            <!-- ××¨×›×™×˜×§×˜×•×¨×” -->
            <section id="architecture">
                <h2><span class="emoji">âš™ï¸</span>××¨×›×™×˜×§×˜×•×¨×” × ×›×•× ×” ×©×œ ×‘×•×˜×™×</h2>

                <h3>ğŸ—ï¸ ××‘× ×” ×©×›×‘×•×ª (Layered Architecture)</h3>

                <p>×”×¤×¨×“ ××ª ×”×§×•×“ ×œ×©×›×‘×•×ª ×‘×¨×•×¨×•×ª, ×›×œ ××—×ª ×¢× ××—×¨×™×•×ª ××•×’×“×¨×ª:</p>

                <div class="card">
                    <div class="card-header">×©×›×‘×•×ª ××•××œ×¦×•×ª</div>
                    
                    <table>
                        <tr>
                            <th>×©×›×‘×”</th>
                            <th>×ª×¤×§×™×“</th>
                            <th>×“×•×’××”</th>
                        </tr>
                        <tr>
                            <td><strong>Handlers</strong></td>
                            <td>×§×‘×œ×ª ×¤×§×•×“×•×ª ××”××©×ª××©</td>
                            <td><code>bot_handlers.py</code></td>
                        </tr>
                        <tr>
                            <td><strong>Services</strong></td>
                            <td>×œ×•×’×™×§×” ×¢×¡×§×™×ª</td>
                            <td><code>services/code_service.py</code></td>
                        </tr>
                        <tr>
                            <td><strong>Repository</strong></td>
                            <td>×’×™×©×” ×œ× ×ª×•× ×™×</td>
                            <td><code>database/repository.py</code></td>
                        </tr>
                        <tr>
                            <td><strong>Models</strong></td>
                            <td>×”×’×“×¨×ª ××‘× ×™ × ×ª×•× ×™×</td>
                            <td><code>database/models.py</code></td>
                        </tr>
                        <tr>
                            <td><strong>Utils</strong></td>
                            <td>×¤×•× ×§×¦×™×•×ª ×¢×–×¨</td>
                            <td><code>utils.py</code></td>
                        </tr>
                    </table>
                </div>

                <h4>×“×•×’××”: ×–×¨×™××ª ×‘×§×©×ª ×©××™×¨×ª ×§×•×‘×¥</h4>

                <pre><code># handlers/save_flow.py
async def get_code(update, context):
    code = update.message.text
    context.user_data['code_to_save'] = code
    return GET_FILENAME

async def get_filename(update, context):
    filename = update.message.text.strip()
    user_id = update.message.from_user.id
    
    # ×§×¨×™××” ×œ×©×›×‘×ª Service
    detected_lang = code_service.detect_language(code, filename)
    
    # ×§×¨×™××” ×œ×©×›×‘×ª Repository
    snippet = CodeSnippet(
        user_id=user_id,
        file_name=filename,
        code=code,
        programming_language=detected_lang
    )
    success = db.save_code_snippet(snippet)
    
    if success:
        await update.message.reply_text("âœ… × ×©××¨ ×‘×”×¦×œ×—×”!")
    return ConversationHandler.END</code></pre>

                <h3>ğŸ”„ Async/Await ××¨×›×™×˜×§×˜×•×¨×”</h3>

                <p>×”×©×ª××© ×‘-async/await ×œ×›×œ ×”×¤×¢×•×œ×•×ª ×©×¢×œ×•×œ×•×ª ×œ×—×¡×•×:</p>

                <div class="comparison-table">
                    <table>
                        <tr>
                            <th>âŒ ×œ× ××•××œ×¥ (Blocking)</th>
                            <th>âœ… ××•××œ×¥ (Async)</th>
                        </tr>
                        <tr>
                            <td><pre><code>def save_file(user_id, code):
    # ×—×•×¡× ××ª ×›×œ ×”×‘×•×˜!
    db.insert_one({...})
    return True</code></pre></td>
                            <td><pre><code>async def save_file(user_id, code):
    # ×××¤×©×¨ ×œ×‘×•×˜ ×œ×˜×¤×œ ×‘×‘×§×©×•×ª ××—×¨×•×ª
    await db.insert_one({...})
    return True</code></pre></td>
                        </tr>
                    </table>
                </div>

                <h3>ğŸ“¦ Conversation Handlers ××•×‘× ×™×</h3>

                <p>×”×©×ª××© ×‘-ConversationHandler ×œ×–×¨×™××•×ª ××•×¨×›×‘×•×ª:</p>

                <pre><code>from telegram.ext import ConversationHandler, CommandHandler, MessageHandler

GET_CODE, GET_FILENAME, GET_NOTE = range(3)

save_conversation = ConversationHandler(
    entry_points=[CommandHandler('save', start_save_flow)],
    states={
        GET_CODE: [MessageHandler(filters.TEXT, get_code)],
        GET_FILENAME: [MessageHandler(filters.TEXT, get_filename)],
        GET_NOTE: [MessageHandler(filters.TEXT, get_note)],
    },
    fallbacks=[CommandHandler('cancel', cancel)]
)</code></pre>

                <div class="success">
                    <strong>âœ… ×”×™×ª×¨×•× ×•×ª:</strong>
                    <ul>
                        <li>×§×•×“ ××¡×•×“×¨ ×•×§×¨×™×</li>
                        <li>×§×œ ×œ×ª×—×–×•×§×”</li>
                        <li>×× ×™×¢×ª ××¦×‘×™× ×œ× ×—×•×§×™×™×</li>
                        <li>×ª××™×›×” ×‘-timeout ×•-cancel</li>
                    </ul>
                </div>

                <h3>ğŸ¯ Separation of Concerns</h3>

                <div class="card">
                    <div class="card-header">×›×œ×œ×™ ×–×”×‘</div>
                    <ul class="checklist">
                        <li>Handler ×œ× ×¢×•×©×” ×©××™×œ×ª×•×ª ×™×©×™×¨×•×ª ×œ××¡×“ × ×ª×•× ×™×</li>
                        <li>Service ×œ× ××›×™×¨ ××ª Telegram API</li>
                        <li>Repository ×œ× ××›×™×œ ×œ×•×’×™×§×” ×¢×¡×§×™×ª</li>
                        <li>Model ××›×™×œ ×¨×§ ×”×’×“×¨×•×ª × ×ª×•× ×™×, ×œ× ×¤×¢×•×œ×•×ª</li>
                    </ul>
                </div>
            </section>

            <!-- × ×™×˜×•×¨ ×•×‘×§×¨×” -->
            <section id="monitoring">
                <h2><span class="emoji">ğŸ§ </span>× ×™×˜×•×¨ ×•×‘×§×¨×” - ×”×œ×‘ ×©×œ ×‘×•×˜ ××§×¦×•×¢×™</h2>

                <h3>ğŸ“ Structured Logging</h3>

                <p>×œ×•×’×™× ×¨×’×™×œ×™× ×˜×•×‘×™× ×œ×¤×™×ª×•×—. ×œ×™×™×¦×•×¨ ×¦×¨×™×š structured logging:</p>

                <div class="comparison-table">
                    <table>
                        <tr>
                            <th>âŒ ×œ×•×’×™× ×¨×’×™×œ×™×</th>
                            <th>âœ… Structured Logs</th>
                        </tr>
                        <tr>
                            <td><pre><code>logger.info(
    f"×§×•×‘×¥ {filename} × ×©××¨"
)</code></pre></td>
                            <td><pre><code>logger.info(
    "file_saved",
    user_id=user_id,
    file_name=filename,
    size_bytes=len(code),
    language=lang
)</code></pre></td>
                        </tr>
                    </table>
                </div>

                <h4>×”×’×“×¨×ª Structlog</h4>

                <pre><code># observability.py
import structlog

def setup_structlog_logging(min_level: str = "INFO"):
    structlog.configure(
        processors=[
            structlog.contextvars.merge_contextvars,  # correlation IDs
            _redact_sensitive,  # ×”×¡×¨×ª ×¡×•×“×•×ª
            structlog.processors.add_log_level,
            structlog.processors.TimeStamper(fmt="iso"),
            structlog.processors.JSONRenderer(),  # JSON ×œ×™×¦×•×¨
        ],
        wrapper_class=structlog.make_filtering_bound_logger(level),
        logger_factory=structlog.PrintLoggerFactory(),
    )

logger = structlog.get_logger()
logger.info("file_saved", user_id=123, file="test.py")</code></pre>

                <h3>ğŸ”— Correlation IDs - ×¢×§×™×‘×” ××—×¨×™ Requests</h3>

                <p>×›×œ request ××§×‘×œ ID ×™×™×—×•×“×™ ×œ×¢×§×™×‘×” ××§×¦×” ×œ×§×¦×”:</p>

                <pre><code># observability.py
import uuid
from contextvars import ContextVar

request_id_var = ContextVar('request_id', default=None)

def generate_request_id() -> str:
    return str(uuid.uuid4())[:8]

async def correlation_middleware(update, context):
    req_id = generate_request_id()
    structlog.contextvars.bind_contextvars(request_id=req_id)
    # ×›×¢×ª ×›×œ ×”×œ×•×’×™× ×™×›×œ×œ×• ××ª ×”-request_id
    return True</code></pre>

                <div class="highlight">
                    <strong>×ª×•×¦××”:</strong> ×œ×•×’×™× ×©×××¤×©×¨×™× ×¢×§×™×‘×” ××œ××” ××—×¨×™ ×›×œ ×¤×¢×•×œ×”
                    <pre><code>{"event": "file_save_start", "request_id": "a3f2c891", "user_id": 123}
{"event": "db_query", "request_id": "a3f2c891", "duration_ms": 45}
{"event": "file_save_success", "request_id": "a3f2c891"}</code></pre>
                </div>

                <h3>âš¡ Performance Tracking</h3>

                <p>××“×•×“ ×›×œ ×¤×¢×•×œ×” ×§×¨×™×˜×™×ª:</p>

                <pre><code># metrics.py
from prometheus_client import Histogram
import time

operation_latency = Histogram(
    "operation_latency_seconds",
    "Operation latency",
    ["operation"]
)

@contextmanager
def track_performance(operation: str):
    start = time.time()
    try:
        yield
    finally:
        duration = time.time() - start
        operation_latency.labels(operation=operation).observe(duration)
        logger.info("performance", operation=operation, duration_ms=duration*1000)

# ×©×™××•×©
async def save_file(user_id, code):
    with track_performance("save_file"):
        await db.insert_one({...})</code></pre>

                <h3>ğŸš¨ Error Tracking ×¢× Sentry</h3>

                <pre><code># observability.py
import sentry_sdk

def init_sentry():
    sentry_sdk.init(
        dsn=os.getenv("SENTRY_DSN"),
        environment=os.getenv("ENVIRONMENT", "production"),
        traces_sample_rate=0.1,  # 10% ×©×œ transactions
        before_send=filter_sensitive_data,  # ××¡× ×Ÿ ×¡×•×“×•×ª
    )</code></pre>

                <h3>ğŸ“Š Prometheus Metrics</h3>

                <div class="card">
                    <div class="card-header">××˜×¨×™×§×•×ª ××•××œ×¦×•×ª</div>
                    <ul>
                        <li><strong>Counters:</strong> ×¡×š ×‘×§×©×•×ª, ×©×’×™××•×ª, ×§×‘×¦×™× ×©× ×©××¨×•</li>
                        <li><strong>Histograms:</strong> ×–×× ×™ ×ª×’×•×‘×”, ×’×“×œ×™ ×§×‘×¦×™×</li>
                        <li><strong>Gauges:</strong> ××©×ª××©×™× ×¤×¢×™×œ×™×, ×§×©×¨×™ DB</li>
                    </ul>
                </div>

                <pre><code>from prometheus_client import Counter, Histogram, Gauge

# ××•× ×™×
files_saved_total = Counter("files_saved_total", "Total files saved")
errors_total = Counter("errors_total", "Total errors", ["type"])

# ×”×™×¡×˜×•×’×¨××•×ª
operation_latency = Histogram(
    "operation_latency_seconds",
    "Operation latency",
    ["operation"]
)

# ×’×™×™×’'×™×
active_users = Gauge("active_users", "Currently active users")</code></pre>

                <h3>ğŸŒ Web Server ×œHealth & Metrics</h3>

                <pre><code># services/webserver.py
from aiohttp import web
from metrics import metrics_endpoint_bytes, metrics_content_type

def create_app():
    app = web.Application()
    
    async def health(request):
        return web.json_response({"status": "ok"})
    
    async def metrics_view(request):
        payload = metrics_endpoint_bytes()
        return web.Response(
            body=payload,
            headers={"Content-Type": metrics_content_type()}
        )
    
    app.router.add_get("/health", health)
    app.router.add_get("/metrics", metrics_view)
    return app</code></pre>
            </section>

            <!-- × ×™×”×•×œ × ×ª×•× ×™× -->
            <section id="data">
                <h2><span class="emoji">ğŸ’¾</span>× ×™×”×•×œ × ×ª×•× ×™× ×•-Cache</h2>

                <h3>ğŸ—„ï¸ MongoDB ×‘×¦×•×¨×” × ×›×•× ×”</h3>

                <h4>××™× ×“×§×¡×™× - ×”×‘×¡×™×¡ ×œ×‘×™×¦×•×¢×™×</h4>

                <pre><code># database/manager.py
from pymongo import IndexModel, ASCENDING, DESCENDING, TEXT

def _create_indexes(self):
    indexes = [
        # ××™× ×“×§×¡×™× ×‘×¡×™×¡×™×™×
        IndexModel([("user_id", ASCENDING)]),
        IndexModel([("file_name", ASCENDING)]),
        IndexModel([("created_at", DESCENDING)]),
        
        # ××™× ×“×§×¡ ××•×¨×›×‘ ×œ×§×¨×™××•×ª × ×¤×•×¦×•×ª
        IndexModel([
            ("user_id", ASCENDING),
            ("is_active", ASCENDING),
            ("updated_at", DESCENDING)
        ], name="user_active_recent_idx"),
        
        # ××™× ×“×§×¡ ×˜×§×¡×˜ ×œ×—×™×¤×•×©
        IndexModel([
            ("code", TEXT),
            ("file_name", TEXT),
            ("description", TEXT)
        ], name="search_idx"),
        
        # TTL index ×œ××—×™×§×” ××•×˜×•××˜×™×ª
        IndexModel(
            [("deleted_expires_at", ASCENDING)],
            name="deleted_ttl",
            expireAfterSeconds=0
        )
    ]
    self.collection.create_indexes(indexes)</code></pre>

                <div class="warning">
                    <strong>âš ï¸ × ×§×•×“×•×ª ×—×©×•×‘×•×ª:</strong>
                    <ul>
                        <li>××™× ×“×§×¡×™× ××©×¤×¨×™× ×§×¨×™××•×ª ××‘×œ ×××˜×™× ×›×ª×™×‘×•×ª - ××¦× ××ª ×”××™×–×•×Ÿ</li>
                        <li>×¢×§×•×‘ ××—×¨×™ index usage ×¢× <code>explain()</code></li>
                        <li>××™× ×“×§×¡×™× ××•×¨×›×‘×™× ×¦×¨×™×›×™× ×œ×”×ª××™× ×œpattern ×©×œ ×”×©××™×œ×ª×•×ª</li>
                    </ul>
                </div>

                <h4>Connection Pooling</h4>

                <pre><code>self.client = MongoClient(
    config.MONGODB_URL,
    maxPoolSize=100,           # ××§×¡×™××•× connections
    minPoolSize=10,            # ××™× ×™××•× connections
    maxIdleTimeMS=300000,      # 5 ×“×§×•×ª ×œ×¤× ×™ ×¡×’×™×¨×”
    socketTimeoutMS=5000,      # timeout ×œ×¤×¢×•×œ×•×ª
    connectTimeoutMS=3000,
    retryWrites=True,
    retryReads=True,
    compressors=['zstd'],      # ×“×—×™×¡×”
)</code></pre>

                <h3>âš¡ Redis Cache</h3>

                <p>Cache ×—×›× ××¤×—×™×ª ×¢×•××¡ ×¢×œ ××¡×“ ×”× ×ª×•× ×™× ×•××©×¤×¨ ×–×× ×™ ×ª×’×•×‘×”:</p>

                <pre><code># cache_manager.py
from functools import wraps
import redis

redis_client = redis.Redis(
    host='localhost',
    port=6379,
    decode_responses=True
)

def cached(expire_seconds=300, key_prefix=""):
    def decorator(func):
        @wraps(func)
        async def wrapper(*args, **kwargs):
            # ×‘× ×™×™×ª ××¤×ª×— cache
            cache_key = f"{key_prefix}:{func.__name__}:{args}:{kwargs}"
            
            # ×‘×“×™×§×ª cache
            cached_value = redis_client.get(cache_key)
            if cached_value:
                return json.loads(cached_value)
            
            # ×§×¨×™××” ×œ×¤×•× ×§×¦×™×”
            result = await func(*args, **kwargs)
            
            # ×©××™×¨×” ×‘-cache
            redis_client.setex(
                cache_key,
                expire_seconds,
                json.dumps(result)
            )
            return result
        return wrapper
    return decorator

# ×©×™××•×©
@cached(expire_seconds=300)
async def get_user_files(user_id: int):
    return db.find({"user_id": user_id}).to_list()</code></pre>

                <h4>××” ×›×“××™ ×œ-Cache?</h4>

                <table>
                    <tr>
                        <th>×¤×¢×•×œ×”</th>
                        <th>TTL ××•××œ×¥</th>
                        <th>×¡×™×‘×”</th>
                    </tr>
                    <tr>
                        <td>×¨×©×™××ª ×§×‘×¦×™×</td>
                        <td>5 ×“×§×•×ª</td>
                        <td>× ×§×¨× ×”×¨×‘×”, ××©×ª× ×” ×œ×¢×™×ª×™× ×¨×—×•×§×•×ª</td>
                    </tr>
                    <tr>
                        <td>×¡×˜×˜×™×¡×˜×™×§×•×ª ××©×ª××©</td>
                        <td>1 ×©×¢×”</td>
                        <td>×—×™×©×•×‘ ×›×‘×“, ×œ× ×§×¨×™×˜×™ ×©×™×”×™×” real-time</td>
                    </tr>
                    <tr>
                        <td>×§×•×‘×¥ ××—×¨×•×Ÿ ×©× ×©××¨</td>
                        <td>30 ×©× ×™×•×ª</td>
                        <td>××©×ª× ×” ×œ×¢×™×ª×™× ×§×¨×•×‘×•×ª</td>
                    </tr>
                    <tr>
                        <td>×§×•× ×¤×™×’×•×¨×¦×™×”</td>
                        <td>24 ×©×¢×•×ª</td>
                        <td>×›××¢×˜ ×œ× ××©×ª× ×”</td>
                    </tr>
                </table>

                <h3>ğŸ—‘ï¸ TTL ×•××—×™×§×” ××•×˜×•××˜×™×ª</h3>

                <p>×”×©×ª××© ×‘-MongoDB TTL indexes ×œ××—×™×§×” ××•×˜×•××˜×™×ª ×©×œ × ×ª×•× ×™× ×–×× ×™×™×:</p>

                <pre><code># ×¡×œ ××™×—×–×•×¨ ×©× ××—×§ ××—×¨×™ 7 ×™××™×
db.collection.update_one(
    {"_id": file_id},
    {
        "$set": {
            "is_active": False,
            "deleted_at": datetime.now(timezone.utc),
            "deleted_expires_at": datetime.now(timezone.utc) + timedelta(days=7)
        }
    }
)

# MongoDB ×™××—×§ ××•×˜×•××˜×™×ª ×›×©×™×’×™×¢ ×œ-deleted_expires_at</code></pre>

                <h3>ğŸ“¦ Repository Pattern</h3>

                <p>×”×¤×¨×“ ×‘×™×Ÿ ×œ×•×’×™×§×ª ×’×™×©×” ×œ× ×ª×•× ×™× ×œ×‘×™×Ÿ ×”×§×•×“ ×”×¢×¡×§×™:</p>

                <pre><code># database/repository.py
class Repository:
    def __init__(self, db_manager):
        self.manager = db_manager
    
    def save_file(self, user_id, file_name, code, language):
        """×©××™×¨×ª ×§×•×‘×¥ ×¢× validation ×•-normalization"""
        # Validation
        if len(code) > MAX_FILE_SIZE:
            raise ValueError("File too large")
        
        # Normalization
        code = normalize_code(code)
        
        # Save
        return self.manager.collection.insert_one({
            "user_id": user_id,
            "file_name": file_name,
            "code": code,
            "programming_language": language,
            "created_at": datetime.now(timezone.utc),
            "is_active": True
        })
    
    def get_file(self, user_id, file_name):
        """×§×¨×™××ª ×§×•×‘×¥ ×¢× cache"""
        return self.manager.collection.find_one({
            "user_id": user_id,
            "file_name": file_name,
            "is_active": True
        })</code></pre>
            </section>

            <!-- ×‘×“×™×§×•×ª -->
            <section id="testing">
                <h2><span class="emoji">ğŸ§ª</span>×‘×“×™×§×•×ª ×•×××™× ×•×ª</h2>

                <h3>ğŸ“Š Coverage - ×›××” ×–×” ××¡×¤×™×§?</h3>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">ğŸ¯ ×™×¢×“×™ Coverage</div>
                        <ul>
                            <li><strong>40%+</strong> - ×‘×¡×™×¡ ×¡×‘×™×¨</li>
                            <li><strong>60%+</strong> - ×˜×•×‘</li>
                            <li><strong>80%+</strong> - ××¦×•×™×Ÿ</li>
                            <li><strong>100%</strong> - ×œ× ×ª××™×“ ×”×’×™×•× ×™</li>
                        </ul>
                    </div>
                    <div class="card">
                        <div class="card-header">ğŸ“ ×”×™×›×Ÿ ×œ×”×ª××§×“</div>
                        <ul>
                            <li>×œ×•×’×™×§×” ×¢×¡×§×™×ª ×§×¨×™×˜×™×ª</li>
                            <li>×¤×•× ×§×¦×™×•×ª ×¢× ×ª× ××™× ××•×¨×›×‘×™×</li>
                            <li>Error handling</li>
                            <li>Edge cases</li>
                        </ul>
                    </div>
                </div>

                <h3>ğŸ—ï¸ ××‘× ×” ×˜×¡×˜×™×</h3>

                <pre><code># tests/test_save_flow.py
import pytest
from unittest.mock import AsyncMock, MagicMock

class TestSaveFlow:
    """×˜×¡×˜×™× ×œ×–×¨×™××ª ×©××™×¨×”"""
    
    @pytest.mark.asyncio
    async def test_save_new_file_success(self, mock_update, mock_context):
        """×‘×“×™×§×”: ×©××™×¨×ª ×§×•×‘×¥ ×—×“×© ××¦×œ×™×—×”"""
        # Given (Arrange)
        user_id = 12345
        filename = "test.py"
        code = 'print("hello")'
        
        mock_context.user_data = {'code_to_save': code}
        mock_update.message.text = filename
        mock_update.message.from_user.id = user_id
        
        # When (Act)
        result = await get_filename(mock_update, mock_context)
        
        # Then (Assert)
        assert result == ConversationHandler.END
        mock_update.message.reply_text.assert_called_once()
        assert "× ×©××¨ ×‘×”×¦×œ×—×”" in mock_update.message.reply_text.call_args[0][0]
    
    @pytest.mark.asyncio
    async def test_save_invalid_filename(self, mock_update, mock_context):
        """×‘×“×™×§×”: ×©× ×§×•×‘×¥ ×œ× ×—×•×§×™ ××—×–×™×¨ ×©×’×™××”"""
        # Given
        mock_update.message.text = "invalid file name!@#"
        
        # When
        result = await get_filename(mock_update, mock_context)
        
        # Then
        assert result == GET_FILENAME  # × ×©××¨ ×‘××•×ª×• state
        assert "××•×–×¨" in mock_update.message.reply_text.call_args[0][0]</code></pre>

                <h3>ğŸ­ Fixtures ×•-Mocks</h3>

                <pre><code># conftest.py
import pytest
from unittest.mock import AsyncMock, MagicMock

@pytest.fixture
def mock_update():
    """Mock ×©×œ Telegram Update"""
    update = MagicMock()
    update.message = AsyncMock()
    update.message.reply_text = AsyncMock()
    update.message.from_user.id = 12345
    return update

@pytest.fixture
def mock_context():
    """Mock ×©×œ Context"""
    context = MagicMock()
    context.user_data = {}
    context.args = []
    return context

@pytest.fixture
async def mongo_db():
    """MongoDB ×œ×˜×¡×˜×™×"""
    client = MongoClient("mongodb://localhost:27017/test_db")
    db = client.test_db
    yield db
    # Cleanup
    client.drop_database("test_db")</code></pre>

                <h3>ğŸ“¦ Integration Tests</h3>

                <pre><code>@pytest.mark.integration
class TestSaveFlowE2E:
    """×˜×¡×˜×™× end-to-end"""
    
    @pytest.mark.asyncio
    async def test_full_save_and_retrieve_flow(self, bot_app, mongo_db):
        """×–×¨×™××” ××œ××”: ×©××™×¨×” ×•××—×–×•×¨"""
        # 1. Save file
        await simulate_command("/save")
        await simulate_message("print('hello')")
        await simulate_message("test.py")
        
        # 2. Verify saved in DB
        saved = mongo_db.collection.find_one({
            "user_id": 12345,
            "file_name": "test.py"
        })
        assert saved is not None
        assert saved['code'] == "print('hello')"
        
        # 3. Retrieve and verify
        await simulate_command("/show test.py")
        # Verify response contains code</code></pre>

                <h3>âš¡ Performance Tests</h3>

                <pre><code>@pytest.mark.performance
class TestPerformance:
    @pytest.mark.asyncio
    async def test_list_1000_files_under_1s(self):
        """×¨×©×™××ª 1000 ×§×‘×¦×™× ×ª×•×š ×¤×—×•×ª ××©× ×™×™×”"""
        # Setup: create 1000 files
        for i in range(1000):
            await db.save_file(user_id=123, file_name=f"file_{i}.py", ...)
        
        # Test
        start = time.time()
        files = await db.get_user_files(user_id=123)
        duration = time.time() - start
        
        assert duration < 1.0, f"Too slow: {duration}s"
        assert len(files) == 1000</code></pre>

                <h3>ğŸ”§ ×”×’×“×¨×ª pytest</h3>

                <pre><code># pytest.ini
[pytest]
testpaths = tests
addopts = 
    -v
    --cov=.
    --cov-report=xml
    --cov-report=term-missing
    --cov-fail-under=60
asyncio_mode = auto</code></pre>

                <h3>ğŸ“ˆ Codecov Integration</h3>

                <pre><code># codecov.yml
coverage:
  status:
    project:
      default:
        target: auto
        threshold: 2%  # ××¤×©×¨ ×™×¨×™×“×” ×©×œ ×¢×“ 2%
    patch:
      default:
        target: 60%  # ×§×•×“ ×—×“×© ×¦×¨×™×š 60% coverage

ignore:
  - "tests/**"
  - "docs/**"</code></pre>
            </section>

            <!-- Logging -->
            <section id="logging">
                <h2><span class="emoji">ğŸ“Š</span>×©×§×™×¤×•×ª ×•×œ×•×’×™× ×—×›××™×</h2>

                <h3>ğŸ¯ ×¢×§×¨×•× ×•×ª Logging ×˜×•×‘</h3>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">âœ… ×›×Ÿ</div>
                        <ul>
                            <li>Structured logging (JSON)</li>
                            <li>Correlation IDs</li>
                            <li>×¨××•×ª ×œ×•×’ × ×›×•× ×•×ª (INFO/WARN/ERROR)</li>
                            <li>×”×§×©×¨ ××¡×¤×™×§ (user_id, file_name)</li>
                            <li>××“×™×“×ª ×‘×™×¦×•×¢×™×</li>
                        </ul>
                    </div>
                    <div class="card">
                        <div class="card-header">âŒ ×œ×</div>
                        <ul>
                            <li>×œ×•×’ ×¡×•×“×•×ª ××• PII</li>
                            <li>×œ×•×’×™× ×‘×¢×‘×¨×™×ª ×‘×œ×‘×“ (×§×©×” ×œgrep)</li>
                            <li>×™×•×ª×¨ ××“×™ ×œ×•×’×™× (noise)</li>
                            <li>×¤×—×•×ª ××“×™ ×œ×•×’×™× (missing context)</li>
                            <li>×œ×•×’×™× ×œ×œ× timestamp</li>
                        </ul>
                    </div>
                </div>

                <h3>ğŸ”’ Sensitive Data Redaction</h3>

                <pre><code># observability.py
def _redact_sensitive(logger, method, event_dict):
    """×”×¡×¨×ª ××™×“×¢ ×¨×’×™×© ××”×œ×•×’×™×"""
    sensitive_keys = {
        "token", "password", "secret", 
        "authorization", "cookie"
    }
    
    for key in list(event_dict.keys()):
        if any(s in key.lower() for s in sensitive_keys):
            event_dict[key] = "[REDACTED]"
    
    return event_dict</code></pre>

                <h3>ğŸ“Š Business Metrics Logging</h3>

                <pre><code># ×œ× ×¨×§ technical metrics - ×’× business metrics!

logger.info(
    "file_saved",
    user_id=user_id,
    language=language,
    size_bytes=len(code),
    is_new_user=(created_at > datetime.now() - timedelta(days=1)),
    timestamp=datetime.now(timezone.utc).isoformat()
)

logger.info(
    "search_performed",
    user_id=user_id,
    query_length=len(query),
    results_count=len(results),
    search_duration_ms=duration * 1000
)</code></pre>

                <h3>ğŸ” Log Aggregation</h3>

                <p>×œ×•×’×™× ×˜×•×‘×™× ×”× ×¨×§ ×—×¦×™ ××”×¡×™×¤×•×¨ - ×¦×¨×™×š ×’× ×›×œ×™× ×œ× ×ª×— ××•×ª×:</p>

                <div class="card">
                    <div class="card-header">×›×œ×™× ××•××œ×¦×™×</div>
                    <ul>
                        <li><strong>ELK Stack</strong> (Elasticsearch, Logstash, Kibana)</li>
                        <li><strong>Grafana Loki</strong> - lightweight</li>
                        <li><strong>Datadog</strong> - managed solution</li>
                        <li><strong>CloudWatch</strong> - ×× ×¢×œ AWS</li>
                    </ul>
                </div>

                <h3>ğŸš¨ Alerting</h3>

                <pre><code># ×“×•×’××ª alert rule (Prometheus)
groups:
  - name: bot_alerts
    rules:
      - alert: HighErrorRate
        expr: rate(errors_total[5m]) > 0.05
        for: 5m
        annotations:
          summary: "×©×™×¢×•×¨ ×©×’×™××•×ª ×’×‘×•×”: {{ $value }}"
          description: "×”×‘×•×˜ ×—×•×•×” {{ $value }} ×©×’×™××•×ª ×œ×“×§×”"
      
      - alert: SlowOperations
        expr: histogram_quantile(0.95, rate(operation_latency_seconds_bucket[5m])) > 2
        for: 10m
        annotations:
          summary: "×¤×¢×•×œ×•×ª ××™×˜×™×•×ª ××“×™"</code></pre>
            </section>

            <!-- ××‘×˜×—×” -->
            <section id="security">
                <h2><span class="emoji">ğŸ›¡ï¸</span>××‘×˜×—×” ×•-Permissions</h2>

                <h3>ğŸ” × ×™×”×•×œ ×¡×•×“×•×ª × ×›×•×Ÿ</h3>

                <div class="danger">
                    <strong>âŒ ×œ×¢×•×œ× ×œ×:</strong>
                    <ul>
                        <li>×œ×”×›× ×™×¡ ×¡×•×“×•×ª ×‘×§×•×“ (hardcoded)</li>
                        <li>×œ×©××•×¨ ×¡×•×“×•×ª ×‘-git history</li>
                        <li>×œ×©×ª×£ ×¡×•×“×•×ª ×‘×¢×¨×•×¦×™× ×œ× ×××•×‘×˜×—×™×</li>
                    </ul>
                </div>

                <div class="success">
                    <strong>âœ… ×ª××™×“:</strong>
                    <ul>
                        <li>×œ×”×©×ª××© ×‘××©×ª× ×™ ×¡×‘×™×‘×”</li>
                        <li>×œ×”×•×¡×™×£ <code>.env</code> ×œ-<code>.gitignore</code></li>
                        <li>×œ×”×¦×¤×™×Ÿ ×¡×•×“×•×ª ×‘××¡×“ × ×ª×•× ×™×</li>
                        <li>×œ×¡×•×‘×‘ (rotate) ×¡×•×“×•×ª ×ª×§×•×¤×ª×™×ª</li>
                    </ul>
                </div>

                <h4>×”×¦×¤× ×ª Tokens</h4>

                <pre><code># secret_manager.py
from cryptography.fernet import Fernet

class SecretManager:
    def __init__(self, encryption_key: str):
        self.cipher = Fernet(encryption_key.encode())
    
    def encrypt(self, plaintext: str) -> str:
        """×”×¦×¤× ×ª ×˜×•×§×Ÿ"""
        return self.cipher.encrypt(plaintext.encode()).decode()
    
    def decrypt(self, ciphertext: str) -> str:
        """×¤×¢× ×•×— ×˜×•×§×Ÿ"""
        return self.cipher.decrypt(ciphertext.encode()).decode()

# ×©×™××•×©
secret_mgr = SecretManager(os.getenv('ENCRYPTION_KEY'))

# ×©××™×¨×”
encrypted_token = secret_mgr.encrypt(github_token)
db.save_token(user_id, encrypted_token)

# ×§×¨×™××”
encrypted = db.get_token(user_id)
github_token = secret_mgr.decrypt(encrypted)</code></pre>

                <h3>ğŸš« Rate Limiting</h3>

                <pre><code># rate_limiter.py
from collections import defaultdict
from datetime import datetime, timedelta

class RateLimiter:
    def __init__(self):
        self.requests = defaultdict(list)
    
    async def check_limit(
        self, 
        user_id: int, 
        max_per_minute: int = 30
    ) -> bool:
        """×‘×“×™×§×”: ×”×× ××©×ª××© ×—×¨×’ ××”××’×‘×œ×”"""
        now = datetime.now()
        one_min_ago = now - timedelta(minutes=1)
        
        # × ×§×” requests ×™×©× ×™×
        self.requests[user_id] = [
            ts for ts in self.requests[user_id]
            if ts > one_min_ago
        ]
        
        # ×‘×“×•×§ limit
        if len(self.requests[user_id]) >= max_per_minute:
            return False  # ×—×¨×’!
        
        self.requests[user_id].append(now)
        return True

# middleware
async def rate_limit_middleware(update, context):
    user_id = update.effective_user.id
    
    if not await rate_limiter.check_limit(user_id):
        await update.message.reply_text(
            "âš ï¸ ×™×•×ª×¨ ××“×™ ×‘×§×©×•×ª! ×× × ×”××ª×Ÿ ×“×§×”."
        )
        raise ApplicationHandlerStop
    
    return True</code></pre>

                <h3>ğŸ” Secret Scanning</h3>

                <pre><code># .github/workflows/security.yml
name: Security Scan

on: [push, pull_request]

jobs:
  gitleaks:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: Run Gitleaks
        uses: gitleaks/gitleaks-action@v2
        with:
          args: detect --no-banner --source .
  
  bandit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
      
      - name: Run Bandit
        run: |
          pip install bandit
          bandit -r . -f json -o bandit-report.json</code></pre>

                <h3>ğŸ›¡ï¸ Input Validation</h3>

                <pre><code>import re

def validate_filename(filename: str) -> bool:
    """××™××•×ª ×©× ×§×•×‘×¥ - ×× ×™×¢×ª path traversal"""
    # ×¨×§ ××•×ª×™×•×ª, ××¡×¤×¨×™×, × ×§×•×“×•×ª ×•×§×•×•×™×
    if not re.match(r'^[\w\.\-\_]+\.[a-zA-Z0-9]+$', filename):
        return False
    
    # ×× ×™×¢×ª path traversal
    if '..' in filename or '/' in filename:
        return False
    
    # ×”×’×‘×œ×ª ××•×¨×š
    if len(filename) > 255:
        return False
    
    return True

def sanitize_code(code: str) -> str:
    """× ×™×§×•×™ ×§×•×“ ××ª×•×•×™× ××¡×•×›× ×™×"""
    # ×”×¡×¨×ª NULL bytes
    code = code.replace('\x00', '')
    
    # ×”×¡×¨×ª ×ª×•×•×™ ×‘×§×¨×” (××œ×‘×“ tab ×•-newline)
    code = ''.join(
        c for c in code 
        if c in ('\t', '\n', '\r') or not unicodedata.category(c).startswith('C')
    )
    
    return code</code></pre>

                <h3>ğŸ”’ Permissions & Access Control</h3>

                <pre><code>async def require_admin(update, context):
    """Decorator ×œ×‘×“×™×§×ª ×”×¨×©××•×ª ××“××™×Ÿ"""
    user_id = update.effective_user.id
    
    if user_id not in ADMIN_USER_IDS:
        await update.message.reply_text("â›” ××™×Ÿ ×œ×š ×”×¨×©××” ×œ×¤×¢×•×œ×” ×–×•")
        raise ApplicationHandlerStop
    
    return True

# ×©×™××•×©
app.add_handler(
    CommandHandler('admin', admin_command, filters=require_admin)
)</code></pre>
            </section>

            <!-- CI/CD -->
            <section id="cicd">
                <h2><span class="emoji">ğŸ”</span>×ª×—×–×•×§×” ×•×©×“×¨×•×’×™× - CI/CD</h2>

                <h3>ğŸ¤– GitHub Actions Pipeline</h3>

                <pre><code># .github/workflows/ci.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ '**' ]

jobs:
  code-quality:
    name: "ğŸ” Code Quality & Security"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.12'
          cache: 'pip'
      
      - name: Install Tools
        run: |
          pip install flake8 black mypy bandit safety
      
      - name: Lint (Flake8)
        run: flake8 . --max-line-length=127
      
      - name: Format Check (Black)
        run: black --check .
      
      - name: Type Check (MyPy)
        run: mypy . --ignore-missing-imports
      
      - name: Security (Bandit)
        run: bandit -r .
  
  unit-tests:
    name: "ğŸ§ª Unit Tests"
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ['3.11', '3.12']
    
    services:
      mongodb:
        image: mongo:6.0
        ports:
          - 27017:27017
      redis:
        image: redis:7-alpine
        ports:
          - 6379:6379
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Python ${{ matrix.python-version }}
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
      
      - name: Install Dependencies
        run: |
          pip install -r requirements.txt
          pip install pytest pytest-cov pytest-asyncio
      
      - name: Run Tests
        run: |
          pytest --cov=. --cov-report=xml
      
      - name: Upload Coverage
        uses: codecov/codecov-action@v4
        with:
          files: coverage.xml</code></pre>

                <h3>ğŸ”„ Dependabot - ×¢×“×›×•× ×™ ×ª×œ×•×™×•×ª ××•×˜×•××˜×™</h3>

                <pre><code># .github/dependabot.yml
version: 2
updates:
  - package-ecosystem: "pip"
    directory: "/"
    schedule:
      interval: "monthly"
      time: "02:00"
      timezone: "UTC"
    open-pull-requests-limit: 10
    
  - package-ecosystem: "docker"
    directory: "/"
    schedule:
      interval: "monthly"</code></pre>

                <h3>ğŸ¤ Auto-merge ×œ×¢×“×›×•× ×™ Patch</h3>

                <pre><code># .github/workflows/dependabot-auto-merge.yml
name: Auto-merge Dependabot

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  auto-merge:
    if: github.actor == 'dependabot[bot]'
    runs-on: ubuntu-latest
    steps:
      - name: Fetch metadata
        id: meta
        uses: dependabot/fetch-metadata@v2
      
      - name: Auto-approve patch updates
        if: steps.meta.outputs.update-type == 'version-update:semver-patch'
        run: gh pr review --approve "$PR_URL"
        env:
          PR_URL: ${{github.event.pull_request.html_url}}
          GITHUB_TOKEN: ${{secrets.GITHUB_TOKEN}}
      
      - name: Enable auto-merge
        if: steps.meta.outputs.update-type == 'version-update:semver-patch'
        run: gh pr merge --auto --squash "$PR_URL"</code></pre>

                <h3>ğŸ“Š Required Status Checks</h3>

                <div class="card">
                    <div class="card-header">×”×’× ×ª Branch</div>
                    <p>×”×’×“×¨ ×‘-GitHub Settings â†’ Branches:</p>
                    <ul class="checklist">
                        <li>Require status checks before merging</li>
                        <li>Require branches to be up to date</li>
                        <li>Status checks: Code Quality, Unit Tests (3.11), Unit Tests (3.12)</li>
                        <li>Require review from code owners</li>
                        <li>Dismiss stale reviews</li>
                    </ul>
                </div>

                <h3>ğŸš€ Deployment Automation</h3>

                <pre><code># .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Deploy to Render
        env:
          RENDER_API_KEY: ${{ secrets.RENDER_API_KEY }}
          RENDER_SERVICE_ID: ${{ secrets.RENDER_SERVICE_ID }}
        run: |
          curl -X POST \
            "https://api.render.com/v1/services/$RENDER_SERVICE_ID/deploys" \
            -H "Authorization: Bearer $RENDER_API_KEY" \
            -H "Content-Type: application/json"
      
      - name: Notify deployment
        run: |
          curl -X POST "https://api.telegram.org/bot$BOT_TOKEN/sendMessage" \
            -d "chat_id=$CHAT_ID" \
            -d "text=ğŸš€ Deploy succeeded to production"</code></pre>

                <h3>ğŸ“ˆ Performance Tests ×‘-CI</h3>

                <pre><code># .github/workflows/performance-tests.yml
name: Performance Tests

on:
  schedule:
    - cron: '0 2 * * 0'  # ×›×œ ×¨××©×•×Ÿ ×‘-2 ×‘×œ×™×œ×”
  workflow_dispatch:

jobs:
  performance:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Run performance tests
        run: |
          pytest tests/performance/ -v --benchmark-only
      
      - name: Upload results
        uses: actions/upload-artifact@v3
        with:
          name: performance-report
          path: performance-results.json</code></pre>
            </section>

            <!-- ×¡×™×›×•× -->
            <section id="summary">
                <h2><span class="emoji">ğŸ“Œ</span>×¡×™×›×•× - Checklist ×œ×‘×•×˜ ××§×¦×•×¢×™</h2>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">âš™ï¸ ××¨×›×™×˜×§×˜×•×¨×”</div>
                        <ul class="checklist">
                            <li>××‘× ×” ×©×›×‘×•×ª ×‘×¨×•×¨</li>
                            <li>Async/await architecture</li>
                            <li>Conversation handlers</li>
                            <li>Separation of concerns</li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ§  × ×™×˜×•×¨</div>
                        <ul class="checklist">
                            <li>Structured logging (structlog)</li>
                            <li>Correlation IDs</li>
                            <li>Sentry ×œ×©×’×™××•×ª</li>
                            <li>Prometheus metrics</li>
                            <li>Health & metrics endpoints</li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ’¾ × ×ª×•× ×™×</div>
                        <ul class="checklist">
                            <li>××™× ×“×§×¡×™× ××ª××™××™×</li>
                            <li>Connection pooling</li>
                            <li>Redis cache</li>
                            <li>Repository pattern</li>
                            <li>TTL ×œ××—×™×§×” ××•×˜×•××˜×™×ª</li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ§ª ×‘×“×™×§×•×ª</div>
                        <ul class="checklist">
                            <li>Coverage > 60%</li>
                            <li>Unit tests</li>
                            <li>Integration tests</li>
                            <li>Performance tests</li>
                            <li>Codecov integration</li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ›¡ï¸ ××‘×˜×—×”</div>
                        <ul class="checklist">
                            <li>Environment variables</li>
                            <li>Secret scanning</li>
                            <li>Token encryption</li>
                            <li>Rate limiting</li>
                            <li>Input validation</li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ” CI/CD</div>
                        <ul class="checklist">
                            <li>GitHub Actions</li>
                            <li>Multiple checks</li>
                            <li>Dependabot</li>
                            <li>Auto-merge patches</li>
                            <li>Deploy automation</li>
                        </ul>
                    </div>
                </div>

                <h3>ğŸ¯ ××“×“×™ ×”×¦×œ×—×”</h3>

                <table class="comparison-table">
                    <tr>
                        <th>××“×“</th>
                        <th>×™×¢×“</th>
                        <th>×¡×˜×˜×•×¡</th>
                    </tr>
                    <tr>
                        <td>Test Coverage</td>
                        <td>> 60%</td>
                        <td><span class="badge badge-success">âœ“</span></td>
                    </tr>
                    <tr>
                        <td>P95 Response Time</td>
                        <td>< 200ms</td>
                        <td><span class="badge badge-success">âœ“</span></td>
                    </tr>
                    <tr>
                        <td>Error Rate</td>
                        <td>< 0.1%</td>
                        <td><span class="badge badge-success">âœ“</span></td>
                    </tr>
                    <tr>
                        <td>Uptime</td>
                        <td>> 99.9%</td>
                        <td><span class="badge badge-success">âœ“</span></td>
                    </tr>
                    <tr>
                        <td>Security Scans</td>
                        <td>0 Critical</td>
                        <td><span class="badge badge-success">âœ“</span></td>
                    </tr>
                </table>

                <div class="highlight">
                    <h3>ğŸ’¡ ×”×¢×™×§×¨×•×Ÿ ×”×—×©×•×‘ ×‘×™×•×ª×¨</h3>
                    <p style="font-size: 1.2em; font-weight: bold;">
                        ×‘×•×˜ ××§×¦×•×¢×™ ×–×” ×œ× ×¨×§ ×§×•×“ ×©×¢×•×‘×“ - ×–×” ××¢×¨×›×ª ×©× ×™×ª×Ÿ ×œ×ª×—×–×§, ×œ×¤×ª×•×¨ ×‘×¢×™×•×ª, ×œ×”×¨×—×™×‘ ×•×œ×©×“×¨×’ ×‘×§×œ×•×ª.
                    </p>
                    <p>
                        ×”×©×§×¢×” ×‘×ª×©×ª×™×•×ª (monitoring, testing, CI/CD) ×—×•×¡×›×ª ×©×¢×•×ª ×¨×‘×•×ª ×‘×¢×ª×™×“ ×•×’×•×¨××ª ×œ×©×™× ×” ×˜×•×‘×” ×‘×œ×™×œ×” ğŸ˜´
                    </p>
                </div>

                <div class="quote">
                    "The best code is the code that never breaks in production.<br>
                    The second best is the code that's easy to debug when it does."
                </div>

                <h3>ğŸš€ ×¦×¢×“×™× ×”×‘××™×</h3>

                <ol>
                    <li><strong>×”×ª×—×œ ×¢× ×”×‘×¡×™×¡:</strong> ×”×’×“×¨ structured logging ×•-health endpoint</li>
                    <li><strong>×”×•×¡×£ monitoring:</strong> Sentry, Prometheus, correlation IDs</li>
                    <li><strong>×›×ª×•×‘ ×˜×¡×˜×™×:</strong> ×”×ª×—×œ ××”×¤×•× ×§×¦×™×•×ª ×”×§×¨×™×˜×™×•×ª, ×¢×‘×•×“ ×œ×›×™×•×•×Ÿ 60%+</li>
                    <li><strong>×”×’×“×¨ CI/CD:</strong> GitHub Actions ×¢× ×‘×“×™×§×•×ª ××•×˜×•××˜×™×•×ª</li>
                    <li><strong>×—×–×§ ××‘×˜×—×”:</strong> Secret scanning, rate limiting, validation</li>
                    <li><strong>××•×¤×˜×™××™×–×¦×™×”:</strong> MongoDB indexes, Redis cache, performance tests</li>
                    <li><strong>×ª×™×¢×•×“:</strong> README ××§×™×£, API docs, code comments</li>
                </ol>
            </section>

            <!-- ××©××‘×™× × ×•×¡×¤×™× -->
            <section id="resources">
                <h2><span class="emoji">ğŸ“š</span>××©××‘×™× × ×•×¡×¤×™×</h2>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">ğŸ”— ×§×™×©×•×¨×™× ×©×™××•×©×™×™×</div>
                        <ul>
                            <li><a href="https://amirbiron.github.io/CodeBot/" target="_blank">CodeBot Docs</a></li>
                            <li><a href="https://github.com/amirbiron/CodeBot" target="_blank">CodeBot Repository</a></li>
                            <li><a href="https://docs.python-telegram-bot.org/" target="_blank">python-telegram-bot</a></li>
                            <li><a href="https://www.structlog.org/" target="_blank">structlog</a></li>
                            <li><a href="https://prometheus.io/" target="_blank">Prometheus</a></li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">ğŸ“– ×§×¨×™××” ××•××œ×¦×ª</div>
                        <ul>
                            <li>Clean Architecture (Robert C. Martin)</li>
                            <li>The Twelve-Factor App</li>
                            <li>Site Reliability Engineering (Google)</li>
                            <li>Designing Data-Intensive Applications</li>
                        </ul>
                    </div>
                </div>

                <div class="success">
                    <strong>ğŸ’¬ ×©××œ×•×ª ××• ×”×¦×¢×•×ª?</strong>
                    <p>××©××— ×œ×©××•×¢ ××©×•×‘ ×¢×œ ×”××“×¨×™×š! ×¦×•×¨ ×§×©×¨ ×“×¨×š:</p>
                    <ul>
                        <li><strong>GitHub Issues:</strong> <a href="https://github.com/amirbiron/CodeBot/issues" target="_blank">×¤×ª×— issue</a></li>
                        <li><strong>Telegram:</strong> <a href="https://t.me/moominAmir" target="_blank">@moominAmir</a></li>
                        <li><strong>Email:</strong> amirbiron@gmail.com</li>
                    </ul>
                </div>
            </section>
        </main>

        <footer>
            <p>
                <strong>ğŸ“ × ×•×¦×¨ ×¢×œ ×™×“×™ Amir Biron</strong><br>
                ××‘×•×¡×¡ ×¢×œ × ×™×¡×™×•×Ÿ ××¢×©×™ ×‘×¤×™×ª×•×— <a href="https://github.com/amirbiron/CodeBot" target="_blank">CodeBot</a>
            </p>
            <p style="margin-top: 20px; color: var(--text-muted);">
                × ×‘× ×” ×‘××”×‘×” ×œ×§×”×™×œ×ª ×”××¤×ª×—×™× ğŸ’š<br>
                <small>×¢×•×“×›×Ÿ ×œ××—×¨×•× ×”: ××•×§×˜×•×‘×¨ 2025</small>
            </p>
        </footer>
    </div>

    <script>
        // Smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Highlight active nav link
        const sections = document.querySelectorAll('section');
        const navLinks = document.querySelectorAll('nav a');

        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.style.background = '';
                link.style.color = '';
                if (link.getAttribute('href') === `#${current}`) {
                    link.style.background = 'var(--accent)';
                    link.style.color = 'var(--primary)';
                }
            });
        });
    </script>
</body>
</html>
